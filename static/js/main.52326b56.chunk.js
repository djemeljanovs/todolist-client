(this["webpackJsonptodolist-client"]=this["webpackJsonptodolist-client"]||[]).push([[0],{49:function(e,t,n){},87:function(e,t,n){"use strict";n.r(t);var r,i=n(0),o=n.n(i),c=n(40),u=n.n(c),a=(n(49),n(3)),s=n(2),d=n(43),l=n(14),b=n(42),f=n.n(b),j=n(1);!function(e){e.INITIALIZING="Initializing",e.CONNECTED="Connected",e.DISCONNECTED="Disconnected",e.ERROR="Connection Error"}(r||(r={}));var O={userId:"",status:r.INITIALIZING,createItem:function(){return{}},focusItem:function(){return{}},blurItem:function(){return{}},updateItem:function(){return{}},removeItem:function(){return{}},items:[]},m=o.a.createContext(O);function h(){var e=o.a.useContext(m);if(!e)throw new Error("useApi must be used within ApiProvider");return e}var g,p=f()("https://ubiquity-todolist-server.herokuapp.com/");function v(e){var t=e.children,n=Object(i.useState)(r.INITIALIZING),o=Object(l.a)(n,2),c=o[0],u=o[1],a=Object(i.useState)([]),s=Object(l.a)(a,2),b=s[0],f=s[1];Object(i.useEffect)((function(){p.on("connect",(function(){u(r.CONNECTED)})),p.on("connect_error",(function(e){u(r.ERROR)})),p.on("disconnect",(function(){u(r.DISCONNECTED)})),p.on(g.LIST,(function(e){f(e)})),p.on(g.CREATE,(function(e){f((function(t){return t.concat(e)}))})),p.on(g.UPDATE,(function(e){console.log("update received: "+JSON.stringify(e)),f((function(t){var n=Object(d.a)(t),r=t.findIndex((function(t){return t._id===e._id}));return r>-1?n[r]=e:n.push(e),n}))})),p.on(g.REMOVE,(function(e){f((function(t){return t.filter((function(t){return t._id!==e._id}))}))}))}),[]);var O=Object(i.useCallback)((function(e,t){p.emit(e,{id:t})}),[]),h=Object(i.useCallback)((function(){p.emit(g.CREATE)}),[]),v=Object(i.useCallback)((function(e,t){p.emit(g.UPDATE,{id:e,text:t})}),[]);return Object(j.jsx)(m.Provider,{value:{userId:p.id,status:c,createItem:h,updateItem:v,focusItem:function(e){return O(g.FOCUS,e)},blurItem:function(e){return O(g.BLUR,e)},removeItem:function(e){return O(g.REMOVE,e)},items:b},children:t})}function I(e){return Object(j.jsx)("svg",Object(a.a)(Object(a.a)({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28"},e),{},{children:Object(j.jsx)("path",{fill:e.color,d:"M28 22.398L19.594 14 28 5.602 22.398 0 14 8.402 5.598 0 0 5.602 8.398 14 0 22.398 5.598 28 14 19.598 22.398 28z"})}))}!function(e){e.LIST="item/list",e.CREATE="item/create",e.FOCUS="item/focus",e.BLUR="item/blur",e.UPDATE="item/update",e.REMOVE="item/remove"}(g||(g={}));var C=Object(s.a)({button:{display:"flex",alignItems:"center",color:"white",padding:20,background:function(e){return e.disabled?"grey":"#5071FD"},border:"none",fontSize:24,fontWeight:"bold",width:"fit-content",borderRadius:10,textTransform:"uppercase",userSelect:"none",cursor:"pointer"}});function x(e){var t=C(e);return Object(j.jsx)("button",Object(a.a)(Object(a.a)({className:t.button},e),{},{children:e.children}))}var E=n(44),N=Object(s.a)({root:{width:"100%",position:"relative",marginRight:10,minWidth:0},badge:{position:"absolute",top:-25,left:10,color:"white",zIndex:100,borderTopLeftRadius:5,borderTopRightRadius:5,padding:5,background:function(e){return e.isControlledByCurrentUser?"#5071FD":"grey"}},input:{height:70,width:"100%",boxSizing:"border-box",border:"3px solid lightgrey",borderRadius:10,fontSize:26,background:"none",paddingLeft:10,"&:focus":{border:"3px solid #5071FD"},"&:disabled":{background:"#EEEEEE",border:"3px solid grey"}}});function w(e){var t=e.isControlled,n=e.isControlledByCurrentUser,r=Object(E.a)(e,["isControlled","isControlledByCurrentUser"]),o=N({isControlled:t,isControlledByCurrentUser:n}),c=Object(i.useState)(r.value),u=Object(l.a)(c,2),s=u[0],d=u[1];return Object(i.useEffect)((function(){d(r.value)}),[r.value]),Object(j.jsxs)("div",{className:o.root,children:[t&&Object(j.jsx)("div",{className:o.badge,children:n?"You are editing":"Someone else is typing"}),Object(j.jsx)("input",Object(a.a)(Object(a.a)({maxLength:30,type:"text",className:o.input,placeholder:"Empty item"},r),{},{value:s,onChange:function(e){r.onChange&&r.onChange(e),d(e.target.value)}}))]})}var y=function(e,t){var n;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var c;return n&&clearTimeout(n),n=setTimeout((function(){c=e.apply(void 0,i)}),t),c}},T=Object(s.a)({root:{display:"flex",width:"100%"}});function R(e){var t=h(),n=t.userId,r=t.removeItem,i=t.focusItem,o=t.blurItem,c=t.updateItem,u=null!=e.controlledBy&&e.controlledBy!==n,a=null!=e.controlledBy&&e.controlledBy===n,s=T(e);return Object(j.jsxs)("div",{className:s.root,children:[Object(j.jsx)(w,{disabled:u,value:e.text,onChange:y((function(t){c(e._id,t.target.value)}),1e3),onFocus:function(){i(e._id)},onBlur:function(){o(e._id)},isControlled:null!=e.controlledBy,isControlledByCurrentUser:a}),Object(j.jsx)(x,{onClick:function(){r(e._id)},disabled:u,tabIndex:-1,children:Object(j.jsx)(I,{width:30,height:30,color:"white"})})]})}var D=Object(s.a)({item:{marginBottom:15}});function S(){var e=D(),t=h().items;return Object(j.jsx)(j.Fragment,{children:t.map((function(t,n){return Object(j.jsx)("div",{className:e.item,children:Object(j.jsx)(R,Object(a.a)({},t))},"item-".concat(n))}))})}var B=Object(s.a)({status:{display:"flex",flexDirection:"row",alignItems:"center"},icon:{height:20,width:20,borderRadius:"50%",background:function(e){return e.color},marginRight:5}});function k(e){switch(e){case r.INITIALIZING:return"yellow";case r.CONNECTED:return"green";case r.DISCONNECTED:return"black";case r.ERROR:return"red"}}function L(){var e=h().status,t=B({color:k(e)});return Object(j.jsxs)("div",{className:t.status,children:[Object(j.jsx)("div",{className:t.icon}),Object(j.jsx)("h4",{children:e.toString().toUpperCase()})]})}var A=Object(s.a)({wrapper:{width:"100%",maxWidth:600,margin:"0 auto",padding:15}});function U(){var e=A(),t=h(),n=t.status,i=t.createItem;return Object(j.jsxs)("div",{className:e.wrapper,children:[Object(j.jsx)("h2",{children:"Multiplayer todo list \ud83d\uddd2\ufe0f"}),Object(j.jsx)(L,{}),Object(j.jsx)(S,{}),Object(j.jsx)(x,{disabled:n!==r.CONNECTED,onClick:i,children:"New item"})]})}var F=function(){return Object(j.jsx)(v,{children:Object(j.jsx)(U,{})})},_=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,88)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),i(e),o(e),c(e)}))};u.a.render(Object(j.jsx)(o.a.StrictMode,{children:Object(j.jsx)(F,{})}),document.getElementById("root")),_()}},[[87,1,2]]]);
//# sourceMappingURL=main.52326b56.chunk.js.map